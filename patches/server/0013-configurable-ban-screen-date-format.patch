From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: booky10 <github@booky.tk>
Date: Mon, 5 Jul 2021 19:58:07 +0200
Subject: [PATCH] configurable ban-screen date format


diff --git a/src/main/java/net/minecraft/server/players/PlayerList.java b/src/main/java/net/minecraft/server/players/PlayerList.java
index 4e40e40257ceb98895777eaf7fb013722aa765a5..b97a62accf812d39bd0b0630a27f40400faa52d5 100644
--- a/src/main/java/net/minecraft/server/players/PlayerList.java
+++ b/src/main/java/net/minecraft/server/players/PlayerList.java
@@ -737,7 +737,7 @@ public abstract class PlayerList {
 
             chatmessage = new TranslatableComponent("multiplayer.disconnect.banned.reason", new Object[]{gameprofilebanentry.getReason()});
             if (gameprofilebanentry.getExpires() != null) {
-                chatmessage.append(new TranslatableComponent("multiplayer.disconnect.banned.expiration", new Object[]{PlayerList.BAN_DATE_FORMAT.format(gameprofilebanentry.getExpires())}));
+                chatmessage.append(new TranslatableComponent("multiplayer.disconnect.banned.expiration", new Object[]{tk.booky.cloudplane.CloudPlaneConfig.expireDateFormat.format(gameprofilebanentry.getExpires())})); // CloudPlane - configurable date format
             }
 
             // return chatmessage;
@@ -750,7 +750,7 @@ public abstract class PlayerList {
 
             chatmessage = new TranslatableComponent("multiplayer.disconnect.banned_ip.reason", new Object[]{ipbanentry.getReason()});
             if (ipbanentry.getExpires() != null) {
-                chatmessage.append(new TranslatableComponent("multiplayer.disconnect.banned_ip.expiration", new Object[]{PlayerList.BAN_DATE_FORMAT.format(ipbanentry.getExpires())}));
+                chatmessage.append(new TranslatableComponent("multiplayer.disconnect.banned_ip.expiration", new Object[]{tk.booky.cloudplane.CloudPlaneConfig.expireDateFormat.format(ipbanentry.getExpires())})); // CloudPlane - configurable date format
             }
 
             // return chatmessage;
diff --git a/src/main/java/tk/booky/cloudplane/CloudPlaneConfig.java b/src/main/java/tk/booky/cloudplane/CloudPlaneConfig.java
index e437153fabb826421b76efc712eaf2baae25addf..c38f6f76ca2520e67599c5e55dea03783af184f1 100644
--- a/src/main/java/tk/booky/cloudplane/CloudPlaneConfig.java
+++ b/src/main/java/tk/booky/cloudplane/CloudPlaneConfig.java
@@ -136,4 +136,9 @@ public class CloudPlaneConfig {
     private static void sleeping() {
         sleepMessage = getString("settings.sleeping.message", sleepMessage);
     }
+
+    public static java.text.SimpleDateFormat expireDateFormat = (java.text.SimpleDateFormat) net.minecraft.server.players.PlayerList.BAN_DATE_FORMAT.clone();
+    private static void banning() {
+        expireDateFormat = new java.text.SimpleDateFormat(getString("settings.banning.date-format", expireDateFormat.toPattern()));
+    }
 }
diff --git a/src/main/java/tk/booky/cloudplane/commands/TempBanCommand.java b/src/main/java/tk/booky/cloudplane/commands/TempBanCommand.java
index 61f6dbeade34e7762aed930b358a9f51b41186aa..9339a3f8db6838d38cfef203e17cd2133c7c9eb2 100644
--- a/src/main/java/tk/booky/cloudplane/commands/TempBanCommand.java
+++ b/src/main/java/tk/booky/cloudplane/commands/TempBanCommand.java
@@ -66,7 +66,7 @@ public class TempBanCommand implements CloudPlaneCommand {
             ServerPlayer target = source.getServer().getPlayerList().getPlayer(profile.getId());
 
             if (target == null) continue;
-            target.connection.disconnect(new TranslatableComponent("multiplayer.disconnect.banned").append(new TranslatableComponent("multiplayer.disconnect.banned.expiration", PlayerList.BAN_DATE_FORMAT.format(expirationDate))), PlayerKickEvent.Cause.BANNED);
+            target.connection.disconnect(new TranslatableComponent("multiplayer.disconnect.banned").append(new TranslatableComponent("multiplayer.disconnect.banned.expiration", tk.booky.cloudplane.CloudPlaneConfig.expireDateFormat.format(expirationDate))), PlayerKickEvent.Cause.BANNED);
         }
 
         if (profiles.size() == 0) {
